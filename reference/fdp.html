<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot f-differential privacy trade-off functions — fdp • fdp</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot f-differential privacy trade-off functions — fdp"><meta name="description" content="Produce a comparative plot of one or more (analytic or empirical) f-differential privacy trade-off functions."><meta property="og:description" content="Produce a comparative plot of one or more (analytic or empirical) f-differential privacy trade-off functions."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fdp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/louisaslett/fdp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot f-differential privacy trade-off functions</h1>
      <small class="dont-index">Source: <a href="https://github.com/louisaslett/fdp/blob/master/R/fdp.R" class="external-link"><code>R/fdp.R</code></a></small>
      <div class="d-none name"><code>fdp.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Produce a comparative plot of one or more (analytic or empirical) f-differential privacy trade-off functions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fdp</span><span class="op">(</span><span class="va">...</span>, .legend <span class="op">=</span> <span class="cn">NULL</span>, .tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>One or more f-DP trade-off specifications. Each argument can be a:</p><ul><li><p>function (user-defined or built-in, e.g. <code><a href="gdp.html">gdp()</a></code>, <code><a href="epsdelta.html">epsdelta()</a></code>, <code><a href="lap.html">lap()</a></code>, etc) that when called with a numeric vector <code>alpha</code> returns a data frame with columns <code>alpha</code> and <code>beta</code>;</p></li>
<li><p>data frame with columns <code>alpha</code> and <code>beta</code>;</p></li>
<li><p>numeric vector of length equal to the internal alpha grid (interpreted as <code>beta</code>).</p></li>
</ul><p>Arguments may be named to control legend labels.
See Details for full explanation of different ways to pass these arguments.</p></dd>


<dt id="arg--legend">.legend<a class="anchor" aria-label="anchor" href="#arg--legend"></a></dt>
<dd><p>Character string giving the legend title.
Use <code>NULL</code> (default) for no title.</p></dd>


<dt id="arg--tol">.tol<a class="anchor" aria-label="anchor" href="#arg--tol"></a></dt>
<dd><p>Numeric tolerance used when:</p><ul><li><p>Validating \(\beta\), <code>beta &lt;= 1 - alpha + .tol</code>.</p></li>
<li><p>Checking convexity for objects forced to draw as lines.</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>ggplot2</code> object of class <code>c("fdp_plot", "gg", "ggplot")</code> displaying the supplied trade-off functions (and points, if applicable).
It can be further modified with additional <code>ggplot2</code> layers or combined with other <code>fdp_plot</code> objects using <code>+</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This is the main plotting function in the package, which produces plots of f-differential privacy (f-DP) trade-off functions in the style shown in the original f-DP paper (Dong et al., 2022).
If you would like a reminder of the formal definition of f-DP, please see further down this documentation page in the "Formal definition" Section.</p>
<p>The <code>...</code> arguments define the trade-off functions to be plotted and can be:</p><ul><li><p>Built-in analytic trade-off function generators such as <code><a href="gdp.html">gdp()</a></code>, <code><a href="epsdelta.html">epsdelta()</a></code>, <code><a href="lap.html">lap()</a></code>.</p></li>
<li><p>User-defined functions defining trade-off functions.</p></li>
<li><p>Data frames containing an <code>alpha</code> and <code>beta</code> column.</p></li>
<li><p>Numeric vectors interpreted as a sequence of <code>beta</code> values over a canonical grid of Type-I error rates <code>alpha = seq(0, 1, by = 0.01)</code>.</p></li>
</ul><p>We cover each of these cases in more detail in the subsequent sub-sections.
After that is a discussion of the two main approaches to modifying the legend labels.</p><div class="section">
<h3 id="built-in-analytic-trade-off-function-generators">Built-in analytic trade-off function generators<a class="anchor" aria-label="anchor" href="#built-in-analytic-trade-off-function-generators"></a></h3>


<p>Most built-in trade-off function generators will take one or more arguments specifying the level of differential privacy, for example, <code>gdp(0.5)</code> corresponding to \(\mu=0.5\)-Gaussian differential privacy.</p>
<p>These function calls can be passed directly, eg <code>fdp(gdp(0.5))</code>, and will automatically provide suitable legend names in the plot, including the detail of any argument specification.
So the example <code>fdp(gdp(0.5))</code> results in a legend label "0.5-GDP".</p>
</div>

<div class="section">
<h3 id="user-defined-trade-off-functions">User-defined trade-off functions<a class="anchor" aria-label="anchor" href="#user-defined-trade-off-functions"></a></h3>


<p>Custom trade-off functions should accept a vector of Type-I error values, \(\alpha\), and return the corresponding vector of Type-II error values, \(\beta\).
In the simplest case, the user defined function will accept a single argument, so in the (unrealistic) perfect privacy setting:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">my_fdp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fl">1</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="op">}</span></span></code></pre><p></p></div>
<p>This can then be plotted by calling <code>fdp(my_fdp)</code>.</p>
<p>However, often there will be a need to pass additional arguments.
This is supported using the direct calling mechanism, so assume an axis offset is required for the above unrealistic example:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">my_fdp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>, <span class="va">off</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">a</span> <span class="op">-</span> <span class="va">off</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre><p></p></div>
<p>This is now called by using the dummy variable <code>alpha</code> (which need not be defined in your calling environment), <code>fdp(my_fdp(alpha, 0.1))</code>, which will produce the trade-off function curve with offset 0.1.</p>
</div>

<div class="section">
<h3 id="data-frames">Data frames<a class="anchor" aria-label="anchor" href="#data-frames"></a></h3>


<p>One need not define a trade-off function explicitly, it can be implicitly defined by giving a set of coordinates \(\{(\alpha_i, \beta_i)\}_{i=1}^n\) in a two-column data frame with columns named <code>alpha</code> and <code>beta</code>.
These coordinates will be linearly interpolated to produce the trade-off function curve.
For example</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">my_fdp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">1</span><span class="op">)</span>, beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.25</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre><p></p></div>
<p>Can be used to produce the f-DP curve corresponding to \(\varepsilon\approx1.09861\)-differential privacy by then calling <code>fdp(my_fdp)</code>.
Of course, that particular example is more easily produced using the built-in analytic trade-off function generator <code><a href="epsdelta.html">epsdelta()</a></code> by calling <code>fdp(epsdelta(1.09861))</code>.</p>
</div>

<div class="section">
<h3 id="numeric-vectors">Numeric vectors<a class="anchor" aria-label="anchor" href="#numeric-vectors"></a></h3>


<p>Finally, it is possible to simply provide a vector of \(\beta\) values at the grid of \(\alpha\) values that <code>fdp()</code> uses internally for plotting — that is, at the values <code>seq(0.0, 1.0, by = 0.01)</code>.
For example,</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.0</span>, <span class="fl">1.0</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">my_fdp</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">a</span></span></code></pre><p></p></div>
<p>would then produce the (unrealistic) perfect f-DP privacy curve by calling <code>fdp(my_fdp)</code>.</p>
</div>

<div class="section">
<h3 id="legend-labels">Legend labels<a class="anchor" aria-label="anchor" href="#legend-labels"></a></h3>


<p>As discussed above, built-in analytic trade-off function generators will provide automatic legend labels that make sense for their particular trade-off function.
In all other cases, the default will be for the legend label to equal the function, data frame, or numeric vector variable name used when calling <code>fdp()</code>.
Thus, in all the examples above where <code>my_fdp</code> was used as the name of the function/data frame/vector the default legend label will be simply "my_fdp".</p>
<p>This default can be overridden in two ways:</p><ol><li><p>by using an argument name.
For example, to set the legend label to "hello" in the user-defined function with offset, one would call <code>fdp(hello = my_fdp(alpha, 0.1))</code>.
This also works with spaces or special characters by using backtick quoted argument names, for example <code>fdp(`So cool!` = my_fdp(alpha, 0.1))</code>.</p></li>
<li><p>by modifying the object passed with <code><a href="fdp_attributes.html">fdp_name()</a></code> in advance.
See the help file for that function for further details.</p></li>
</ol></div>

<div class="section">
<h3 id="drawing-method-and-validation">Drawing method and validation<a class="anchor" aria-label="anchor" href="#drawing-method-and-validation"></a></h3>


<p>By default, built-in and user-defined function arguments will be plotted as a trade-off function curve.
This means that they will first be checked to ensure the rendered line is indeed a valid trade-off function: that is, convex, non-increasing and less than \(1-\alpha\) (however, technically continuity cannot be checked with a finite number of calls to a black-box function).
If a problem is detected an error will be thrown.
<strong>Note</strong> that due to the finite precision nature of computers, it might be that these validity checks throw a false alarm, in which case you may use the <code>.tol</code> argument to increase the tolerance within which these validity checks must pass.</p>
<p>In contrast, data frame/vector arguments are plotted differently depending on their size.
If there are at least 100 rows/elements then these will be treated in the same way as built-in and user-defined function arguments, with trade-off function validity checks.
However, if there are fewer rows/elements, then these will be treated as merely a collection of points, the only check being that they all lie below the \(\beta = 1-\alpha\) line.
Those points will then be plotted, together with the lower convex hull which corresponds to the lower bounding trade-off function for that collection of points.</p>
<p>This default behaviour of validating and drawing a line versus computing lower convex hull and plotting points can be controlled with the <code><a href="fdp_attributes.html">fdp_point()</a></code> and <code><a href="fdp_attributes.html">fdp_line()</a></code> functions.
See those help files for further details.</p>
<p>A final performance note: all function type arguments are evaluated on a uniform grid <code>alpha = seq(0, 1, 0.01)</code>.
To use a custom resolution, supply an explicit data frame instead of a function.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="formal-definition-dong-et-al-">Formal definition (Dong et al., 2022)<a class="anchor" aria-label="anchor" href="#formal-definition-dong-et-al-"></a></h2>
    <p>For any two probability distributions \(P\) and \(Q\) on the same space, the trade-off function
$$T(P,Q) \colon [0,1] \to [0,1]$$
characterises the optimal relationship between Type I and Type II errors in a hypothesis test distinguishing between them. It is defined as:
$$T(P, Q)(\alpha) = \inf \left\{ \beta_\phi \colon \alpha_\phi \leq \alpha \right\}$$
where the infimum is taken over all measurable rejection rules \(\phi\).
The terms \(\alpha_\phi = \mathbb{E}_P[\phi]\) and \(\beta_\phi = 1 - \mathbb{E}_Q[\phi]\) represent the Type I and Type II errors, respectively.</p>
<p>A function \(f \colon [0,1] \to [0,1]\) is a trade-off function if and only if it is convex, continuous, non-increasing, and satisfies \(f(x) \le 1-x\) for all \(x \in [0,1]\).</p>
<p>In the context of differential privacy, we are interested in the distributions of the output of a randomised algorithm when run on two neighbouring datasets (datasets that differ in a single record), \(S\) and \(S'\). Let \(M\) be a randomised algorithm which has output probability distribution denoted \(M(S)\) when applied to dataset \(S\). Then, each pair of neighbouring datasets generate a specific trade-off function \(T(M(S), M(S'))\) which characterises how hard it is to distinguish between whether dataset \(S\) or \(S'\) has been used to produce the released output. Considering all possible neighbouring datasets leads to a family of trade-off functions, the lower bound of which determines the privacy of the randomised algorithm.</p>
<p>More formally, let \(f\) be a trade-off function.
A randomised algorithm \(M\) is said to be \(f\)-differentially private (f-DP) if for any pair of neighbouring datasets \(S\) and \(S'\), the following condition holds:
$$T(M(S), M(S')) \ge f$$
This definition means that the task of distinguishing whether the mechanism was run on dataset \(S\) or its neighbour \(S'\) is at least as difficult as distinguishing between two canonical distributions whose trade-off function is \(f\).</p>
<p>Therefore, this function is concerned with plotting \(T(P,Q) \colon [0,1] \to [0,1]\) or \(f \colon [0,1] \to [0,1]\).
That is, plotting a function which returns the smallest type-II error for a specified type-I error rate.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Andrew, A. M. (1979). “Another efficient algorithm for convex hulls in two dimensions”. <em>Information Processing Letters</em>, <strong>9</strong>(5), 216–219. <a href="https://doi.org/10.1016/0020-0190%2879%2990072-3" class="external-link">doi:10.1016/0020-0190(79)90072-3</a>
.</p>
<p>Dong, J., Roth, A. and Su, W.J. (2022). “Gaussian Differential Privacy”. <em>Journal of the Royal Statistical Society Series B</em>, <strong>84</strong>(1), 3–37. <a href="https://doi.org/10.1111/rssb.12454" class="external-link">doi:10.1111/rssb.12454</a>
.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Plotting mu=1 Gaussian differential privacy</span></span></span>
<span class="r-in"><span><span class="fu">fdp</span><span class="op">(</span><span class="fu"><a href="gdp.html">gdp</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fdp-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plotting the f_(epsilon,delta) curve corresponding to (1, 0.1)-differential privacy</span></span></span>
<span class="r-in"><span><span class="fu">fdp</span><span class="op">(</span><span class="fu"><a href="epsdelta.html">epsdelta</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fdp-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># These can be plotted together for comparison</span></span></span>
<span class="r-in"><span><span class="fu">fdp</span><span class="op">(</span><span class="fu"><a href="gdp.html">gdp</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="epsdelta.html">epsdelta</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fdp-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The same curves custom labels and a custom legend header</span></span></span>
<span class="r-in"><span><span class="fu">fdp</span><span class="op">(</span><span class="st">"Gaussian DP"</span> <span class="op">=</span> <span class="fu"><a href="gdp.html">gdp</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Classical DP"</span> <span class="op">=</span> <span class="fu"><a href="epsdelta.html">epsdelta</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    .legend <span class="op">=</span> <span class="st">"Methods"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fdp-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Alternatively, combine separate fdp() calls using +</span></span></span>
<span class="r-in"><span><span class="fu">fdp</span><span class="op">(</span><span class="fu"><a href="gdp.html">gdp</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">fdp</span><span class="op">(</span><span class="fu"><a href="epsdelta.html">epsdelta</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fdp-5.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Louis Aslett.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

